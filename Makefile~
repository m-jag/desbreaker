#Variables
APP = desbreaker

#Usual compilation flags
CFLAGS=-std=c99 -Wall -Wextra -g -O2
CPPFLAGS=-I -DDEBUG
LDFLAGS=-lm

#Special rules and targets
.PHONY: all clean help genkey

#Rules and targets
all: $(APP)

$(APP): DES.o main.o comparefile.o
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

main.o: main.c DES.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

genkey: genkey.o DES.o
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

genkey.o: genkey.c DES.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<	

DES.o: DES.c DES.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

comparefile.o: comparefile.c comparefile.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

clean:
	@rm -f *.o $(APP) genkey

help :
	@echo -e "Usage :"
	@echo -e "  make all		build the software"
	@echo -e "  make genkey		build the key generator"
	@echo -e "  make clean		remove all files generated by make"
	@echo -e "  make help		display this help"
